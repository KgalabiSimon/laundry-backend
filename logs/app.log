2025-08-07 13:13:46,650 - app.main - INFO - Starting LaundryPro API...
2025-08-07 13:14:04,047 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-07 13:14:04,150 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-07 13:14:04,696 - sqlalchemy.engine.Engine - DEBUG - Col ('version',)
2025-08-07 13:14:04,702 - sqlalchemy.engine.Engine - DEBUG - Row ('PostgreSQL 12.22 (Ubuntu 12.22-0ubuntu0.20.04.4) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0, 64-bit',)
2025-08-07 13:14:04,705 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-07 13:14:04,708 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-07 13:14:04,787 - sqlalchemy.engine.Engine - DEBUG - Col ('current_schema',)
2025-08-07 13:14:04,810 - sqlalchemy.engine.Engine - DEBUG - Row ('public',)
2025-08-07 13:14:04,940 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-07 13:14:04,944 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-07 13:14:04,945 - sqlalchemy.engine.Engine - DEBUG - Col ('standard_conforming_strings',)
2025-08-07 13:14:04,947 - sqlalchemy.engine.Engine - DEBUG - Row ('on',)
2025-08-07 13:14:04,950 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-07 13:14:04,974 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:05,177 - sqlalchemy.engine.Engine - INFO - [generated in 0.20339s] {'table_name': 'users', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:06,916 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:06,918 - sqlalchemy.engine.Engine - DEBUG - Row ('users',)
2025-08-07 13:14:06,919 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:06,920 - sqlalchemy.engine.Engine - INFO - [cached since 1.947s ago] {'table_name': 'customers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:06,936 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:06,937 - sqlalchemy.engine.Engine - DEBUG - Row ('customers',)
2025-08-07 13:14:06,938 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:06,947 - sqlalchemy.engine.Engine - INFO - [cached since 1.973s ago] {'table_name': 'workers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:06,959 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:06,963 - sqlalchemy.engine.Engine - DEBUG - Row ('workers',)
2025-08-07 13:14:06,964 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:06,965 - sqlalchemy.engine.Engine - INFO - [cached since 1.992s ago] {'table_name': 'service_types', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:06,967 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:06,970 - sqlalchemy.engine.Engine - DEBUG - Row ('service_types',)
2025-08-07 13:14:06,975 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:06,976 - sqlalchemy.engine.Engine - INFO - [cached since 2.003s ago] {'table_name': 'orders', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:06,979 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:06,980 - sqlalchemy.engine.Engine - DEBUG - Row ('orders',)
2025-08-07 13:14:06,986 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:06,987 - sqlalchemy.engine.Engine - INFO - [cached since 2.014s ago] {'table_name': 'order_items', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:06,990 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:06,992 - sqlalchemy.engine.Engine - DEBUG - Row ('order_items',)
2025-08-07 13:14:06,993 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:06,996 - sqlalchemy.engine.Engine - INFO - [cached since 2.022s ago] {'table_name': 'order_status_history', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:06,998 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:07,007 - sqlalchemy.engine.Engine - DEBUG - Row ('order_status_history',)
2025-08-07 13:14:07,010 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,012 - sqlalchemy.engine.Engine - INFO - [cached since 2.038s ago] {'table_name': 'points_transactions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,119 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:07,120 - sqlalchemy.engine.Engine - DEBUG - Row ('points_transactions',)
2025-08-07 13:14:07,123 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,125 - sqlalchemy.engine.Engine - INFO - [cached since 2.151s ago] {'table_name': 'loyalty_tier_configs', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,130 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:07,133 - sqlalchemy.engine.Engine - DEBUG - Row ('loyalty_tier_configs',)
2025-08-07 13:14:07,136 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,143 - sqlalchemy.engine.Engine - INFO - [cached since 2.169s ago] {'table_name': 'subscription_plan_configs', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,149 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:07,151 - sqlalchemy.engine.Engine - DEBUG - Row ('subscription_plan_configs',)
2025-08-07 13:14:07,160 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,163 - sqlalchemy.engine.Engine - INFO - [cached since 2.19s ago] {'table_name': 'message_templates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,166 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:07,168 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,169 - sqlalchemy.engine.Engine - INFO - [cached since 2.196s ago] {'table_name': 'notifications', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,183 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:07,185 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,189 - sqlalchemy.engine.Engine - INFO - [cached since 2.216s ago] {'table_name': 'notification_preferences', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,193 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:07,194 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,196 - sqlalchemy.engine.Engine - INFO - [cached since 2.222s ago] {'table_name': 'webhook_events', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,201 - sqlalchemy.engine.Engine - DEBUG - Col ('relname',)
2025-08-07 13:14:07,209 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,210 - sqlalchemy.engine.Engine - INFO - [generated in 0.00222s] {'typname_1': 'userrole', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,315 - sqlalchemy.engine.Engine - DEBUG - Col ('typname',)
2025-08-07 13:14:07,316 - sqlalchemy.engine.Engine - DEBUG - Row ('userrole',)
2025-08-07 13:14:07,320 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,322 - sqlalchemy.engine.Engine - INFO - [cached since 0.1138s ago] {'typname_1': 'loyaltytier', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,325 - sqlalchemy.engine.Engine - DEBUG - Col ('typname',)
2025-08-07 13:14:07,326 - sqlalchemy.engine.Engine - DEBUG - Row ('loyaltytier',)
2025-08-07 13:14:07,329 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,331 - sqlalchemy.engine.Engine - INFO - [cached since 0.1229s ago] {'typname_1': 'subscriptionplan', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,334 - sqlalchemy.engine.Engine - DEBUG - Col ('typname',)
2025-08-07 13:14:07,335 - sqlalchemy.engine.Engine - DEBUG - Row ('subscriptionplan',)
2025-08-07 13:14:07,337 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,339 - sqlalchemy.engine.Engine - INFO - [cached since 0.1312s ago] {'typname_1': 'workerrole', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,343 - sqlalchemy.engine.Engine - DEBUG - Col ('typname',)
2025-08-07 13:14:07,343 - sqlalchemy.engine.Engine - DEBUG - Row ('workerrole',)
2025-08-07 13:14:07,346 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,348 - sqlalchemy.engine.Engine - INFO - [cached since 0.1399s ago] {'typname_1': 'servicecategory', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,353 - sqlalchemy.engine.Engine - DEBUG - Col ('typname',)
2025-08-07 13:14:07,354 - sqlalchemy.engine.Engine - DEBUG - Row ('servicecategory',)
2025-08-07 13:14:07,357 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,360 - sqlalchemy.engine.Engine - INFO - [cached since 0.1523s ago] {'typname_1': 'orderstatus', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,365 - sqlalchemy.engine.Engine - DEBUG - Col ('typname',)
2025-08-07 13:14:07,367 - sqlalchemy.engine.Engine - DEBUG - Row ('orderstatus',)
2025-08-07 13:14:07,370 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,375 - sqlalchemy.engine.Engine - INFO - [cached since 0.1671s ago] {'typname_1': 'transactiontype', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,377 - sqlalchemy.engine.Engine - DEBUG - Col ('typname',)
2025-08-07 13:14:07,378 - sqlalchemy.engine.Engine - DEBUG - Row ('transactiontype',)
2025-08-07 13:14:07,382 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:07,386 - sqlalchemy.engine.Engine - INFO - [cached since 0.1777s ago] {'typname_1': 'notificationtype', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:07,388 - sqlalchemy.engine.Engine - DEBUG - Col ('typname',)
2025-08-07 13:14:07,390 - sqlalchemy.engine.Engine - INFO - CREATE TYPE notificationtype AS ENUM ('ORDER_CONFIRMATION', 'STATUS_UPDATE', 'PICKUP_REMINDER', 'DELIVERY_REMINDER', 'PAYMENT_CONFIRMATION', 'LOYALTY_UPDATE', 'PROMOTIONAL', 'FEEDBACK_REQUEST', 'CUSTOM')
2025-08-07 13:14:07,390 - sqlalchemy.engine.Engine - INFO - [no key 0.00078s] {}
2025-08-07 13:14:14,505 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = %(typname_1)s AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-07 13:14:14,509 - sqlalchemy.engine.Engine - INFO - [cached since 7.302s ago] {'typname_1': 'messagestatus', 'nspname_1': 'pg_catalog'}
2025-08-07 13:14:14,543 - sqlalchemy.engine.Engine - DEBUG - Col ('typname',)
2025-08-07 13:14:14,569 - sqlalchemy.engine.Engine - INFO - CREATE TYPE messagestatus AS ENUM ('PENDING', 'SENT', 'DELIVERED', 'READ', 'FAILED', 'REJECTED')
2025-08-07 13:14:14,591 - sqlalchemy.engine.Engine - INFO - [no key 0.02161s] {}
2025-08-07 13:14:14,698 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE message_templates (
	id SERIAL NOT NULL, 
	name VARCHAR NOT NULL, 
	notification_type notificationtype NOT NULL, 
	template_name VARCHAR NOT NULL, 
	language_code VARCHAR NOT NULL, 
	header_text TEXT, 
	body_text TEXT NOT NULL, 
	footer_text TEXT, 
	parameters JSON, 
	has_buttons BOOLEAN, 
	button_config JSON, 
	has_media BOOLEAN, 
	media_type VARCHAR, 
	is_active BOOLEAN, 
	is_approved BOOLEAN, 
	created_at TIMESTAMP WITH TIME ZONE DEFAULT now(), 
	updated_at TIMESTAMP WITH TIME ZONE, 
	PRIMARY KEY (id)
)


2025-08-07 13:14:15,006 - sqlalchemy.engine.Engine - INFO - [no key 0.30854s] {}
2025-08-07 13:14:18,698 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_message_templates_id ON message_templates (id)
2025-08-07 13:14:18,701 - sqlalchemy.engine.Engine - INFO - [no key 0.00289s] {}
2025-08-07 13:14:18,804 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_message_templates_name ON message_templates (name)
2025-08-07 13:14:18,808 - sqlalchemy.engine.Engine - INFO - [no key 0.00365s] {}
2025-08-07 13:14:18,898 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE notification_preferences (
	id SERIAL NOT NULL, 
	customer_id INTEGER NOT NULL, 
	whatsapp_opted_in BOOLEAN, 
	whatsapp_phone VARCHAR, 
	order_updates BOOLEAN, 
	pickup_reminders BOOLEAN, 
	promotional_messages BOOLEAN, 
	loyalty_updates BOOLEAN, 
	feedback_requests BOOLEAN, 
	preferred_language VARCHAR, 
	preferred_time_start VARCHAR, 
	preferred_time_end VARCHAR, 
	timezone VARCHAR, 
	created_at TIMESTAMP WITH TIME ZONE DEFAULT now(), 
	updated_at TIMESTAMP WITH TIME ZONE, 
	opted_out_at TIMESTAMP WITH TIME ZONE, 
	PRIMARY KEY (id), 
	UNIQUE (customer_id), 
	FOREIGN KEY(customer_id) REFERENCES customers (id)
)


2025-08-07 13:14:18,970 - sqlalchemy.engine.Engine - INFO - [no key 0.07269s] {}
2025-08-07 13:14:20,477 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_notification_preferences_id ON notification_preferences (id)
2025-08-07 13:14:20,483 - sqlalchemy.engine.Engine - INFO - [no key 0.00653s] {}
2025-08-07 13:14:20,546 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE notifications (
	id SERIAL NOT NULL, 
	customer_id INTEGER NOT NULL, 
	template_id INTEGER, 
	order_id INTEGER, 
	notification_type notificationtype NOT NULL, 
	recipient_phone VARCHAR NOT NULL, 
	message_text TEXT NOT NULL, 
	whatsapp_message_id VARCHAR, 
	template_name VARCHAR, 
	template_language VARCHAR, 
	template_parameters JSON, 
	media_url VARCHAR, 
	media_type VARCHAR, 
	status messagestatus, 
	delivery_status VARCHAR, 
	error_message TEXT, 
	retry_count INTEGER, 
	scheduled_at TIMESTAMP WITH TIME ZONE, 
	sent_at TIMESTAMP WITH TIME ZONE, 
	delivered_at TIMESTAMP WITH TIME ZONE, 
	read_at TIMESTAMP WITH TIME ZONE, 
	meta_data JSON, 
	created_at TIMESTAMP WITH TIME ZONE DEFAULT now(), 
	updated_at TIMESTAMP WITH TIME ZONE, 
	PRIMARY KEY (id), 
	FOREIGN KEY(customer_id) REFERENCES customers (id), 
	FOREIGN KEY(template_id) REFERENCES message_templates (id), 
	FOREIGN KEY(order_id) REFERENCES orders (id)
)


2025-08-07 13:14:20,697 - sqlalchemy.engine.Engine - INFO - [no key 0.15162s] {}
2025-08-07 13:14:21,197 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_notifications_id ON notifications (id)
2025-08-07 13:14:21,203 - sqlalchemy.engine.Engine - INFO - [no key 0.00654s] {}
2025-08-07 13:14:21,430 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_notifications_whatsapp_message_id ON notifications (whatsapp_message_id)
2025-08-07 13:14:21,434 - sqlalchemy.engine.Engine - INFO - [no key 0.00351s] {}
2025-08-07 13:14:21,728 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE webhook_events (
	id SERIAL NOT NULL, 
	event_type VARCHAR NOT NULL, 
	whatsapp_message_id VARCHAR, 
	notification_id INTEGER, 
	status VARCHAR, 
	timestamp TIMESTAMP WITH TIME ZONE, 
	raw_data JSON NOT NULL, 
	processed BOOLEAN, 
	processed_at TIMESTAMP WITH TIME ZONE, 
	created_at TIMESTAMP WITH TIME ZONE DEFAULT now(), 
	PRIMARY KEY (id), 
	FOREIGN KEY(notification_id) REFERENCES notifications (id)
)


2025-08-07 13:14:21,764 - sqlalchemy.engine.Engine - INFO - [no key 0.03692s] {}
2025-08-07 13:14:21,939 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_webhook_events_whatsapp_message_id ON webhook_events (whatsapp_message_id)
2025-08-07 13:14:21,941 - sqlalchemy.engine.Engine - INFO - [no key 0.00244s] {}
2025-08-07 13:14:22,134 - sqlalchemy.engine.Engine - INFO - CREATE INDEX ix_webhook_events_id ON webhook_events (id)
2025-08-07 13:14:22,142 - sqlalchemy.engine.Engine - INFO - [no key 0.00688s] {}
2025-08-07 13:14:22,236 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-07 13:14:22,415 - app.main - INFO - Database tables created/verified
2025-08-07 13:14:23,037 - app.utils.init_data - ERROR - Error initializing default data: Could not determine join condition between parent/child tables on relationship User.worker_profile - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-08-07 13:27:43,871 - app.main - ERROR - Global exception: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: Could not determine join condition between parent/child tables on relationship User.worker_profile - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
Traceback (most recent call last):
  File "/home/tshepo/.local/lib/python3.8/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
  File "/home/tshepo/.local/lib/python3.8/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
  File "/home/tshepo/.local/lib/python3.8/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
  File "/mnt/c/Users/Naspers/Documents/laundrySystems/laundry-api/app/main.py", line 70, in add_process_time_header
    response = await call_next(request)
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/home/tshepo/.local/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/home/tshepo/.local/lib/python3.8/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/home/tshepo/.local/lib/python3.8/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
  File "/home/tshepo/.local/lib/python3.8/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
  File "/home/tshepo/.local/lib/python3.8/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/mnt/c/Users/Naspers/Documents/laundrySystems/laundry-api/app/api/v1/endpoints/auth.py", line 25, in login
    user = authenticate_user(db, user_credentials.email, user_credentials.password)
  File "/mnt/c/Users/Naspers/Documents/laundrySystems/laundry-api/app/core/auth.py", line 151, in authenticate_user
    user = db.query(User).filter(User.email == email).first()
  File "/home/tshepo/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 2912, in query
    return self._query_cls(entities, self, **kwargs)
  File "/home/tshepo/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 276, in __init__
    self._set_entities(entities)
  File "/home/tshepo/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 288, in _set_entities
    self._raw_columns = [
  File "/home/tshepo/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 289, in <listcomp>
    coercions.expect(
  File "/home/tshepo/.local/lib/python3.8/site-packages/sqlalchemy/sql/coercions.py", line 406, in expect
    insp._post_inspect
  File "/home/tshepo/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 1260, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/home/tshepo/.local/lib/python3.8/site-packages/sqlalchemy/orm/mapper.py", line 2707, in _post_inspect
    self._check_configure()
  File "/home/tshepo/.local/lib/python3.8/site-packages/sqlalchemy/orm/mapper.py", line 2386, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/home/tshepo/.local/lib/python3.8/site-packages/sqlalchemy/orm/mapper.py", line 4199, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/home/tshepo/.local/lib/python3.8/site-packages/sqlalchemy/orm/mapper.py", line 4236, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[User(users)]'. Original exception was: Could not determine join condition between parent/child tables on relationship User.worker_profile - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-08-07 13:38:36,625 - app.main - INFO - Shutting down LaundryPro API...
